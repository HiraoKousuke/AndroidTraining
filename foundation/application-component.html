<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title></title>
</head>

<body>
	<h1 id="-">アクティビティとは？</h1>
	<h2 id="1-">1. アクティビティとは？</h2>
	<ul>
		<li>UI を持ち1つの画面を現すコンポーネント。 </li>
		<li>フォアグラウンドで実行状態、バックグラウンドで停止状態のように、見える(触れる)状態によるライフサイクルを持つ。</li>
	</ul>
	<h2 id="2-">2. アクティビティの構成要素</h2>
	<ul>
		<li>アクティビティ自体は Java のクラスで、そこに UI部品（これも Java クラス）を追加することで画面が作られている。 </li>
		<li>
			<p>アクティビティを構成する UI 部品としては大きく2種類がある。</p>
			<ul>
				<li>
					<p>『ビュー』</p>
					<ul>
						<li>テキスト、ボタン、画像などの UI として形状を持つ部品</li>
					</ul>
				</li>
				<li>
					<p>『レイアウト』</p>
					<ul>
						<li>UI としての形状を持たずビューをグループ化し表示位置を制御する部品</li>
					</ul>
				</li>
			</ul>
		</li>
	</ul>
	<p>※イメージとして Activity 内にビュー、レイアウトのインスタンスが階層構造で追加されている感じ。XML の DOM と同じと考えても良い。 </p>
	<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>Activity</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>Layout</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>View1</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;View2</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>Layout</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>View3</span></span></span></div></pre>
	<ul>
		<li>アクティビティに UI 部品を追加する方法は2つある。
			<ol>
				<li>UI 部品の配置を記述したXMLファイル(レイアウトファイル)で追加する方法。</li>
				<li>UI 部品の Java クラスのインスタンスを生成し追加する方法。</li>
			</ol>
		</li>
	</ul>
	<p>※両方とも例は後述</p>

	<h1 id="-">アクティビティの作り方</h1>
	<h2 id="-">手順</h2>
	<ol>
		<li>Activity クラスの継承 ・アクティビティは Activity クラスのサブクラスとして作る。</li>
		<li>onCreate() メソッドのオーバーライド
			<ul>
				<li>アクティビティが起動すると最初に呼ばれるメソッド「onCreate()」をオーバーライドする。</li>
				<li>ここで画面に UI を設定する。</li>
			</ul>
		</li>
	</ol>
	<h2 id="-">ポイント</h2>
	<ul>
		<li>
			<p>Activity#setContentView() はレイアウトファイルに定義された UI をアクティビティにセットするメソッド。 setContentView(レイアウトファイルのリソースID)
			</p>
		</li>
		<li>
			<p>レイアウトファイルのリソースIDは「R.layout.レイアウトファイル名」</p>
		</li>
	</ul>
	<h2 id="-">サンプル</h2>
	<p>[HelloActivity.java]</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="meta class java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta class identifier java"><span class="storage modifier java"><span>class</span></span><span>&nbsp;</span><span class="entity name type class java"><span>HelloActivity</span></span></span><span>&nbsp;</span><span class="meta definition class inherited classes java"><span class="storage modifier extends java"><span>extends</span></span><span>&nbsp;</span><span class="entity other inherited-class java"><span>Activity</span></span><span>&nbsp;</span></span><span class="punctuation section class begin bracket curly java"><span>{</span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive java"><span>void</span></span></span><span>&nbsp;</span><span class="meta method identifier java"><span class="entity name function java"><span>onCreate</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>Bundle</span></span><span>&nbsp;</span><span class="variable parameter java"><span>savedInstanceState</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section method begin bracket curly java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language java"><span>super</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>onCreate</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>savedInstanceState</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="punctuation whitespace comment leading java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;レイアウトファイルを使ってアクティビティにUI部品を追加</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>setContentView</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="variable other object java"><span>R</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>layout</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>hello</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end bracket curly java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="punctuation section class end bracket curly java"><span>}</span></span></span></span></div></pre>
	<p>[res/hello.xml]</p>
	<pre class="editor-colors lang-xml"><div class="line"><span class="text xml"><span class="meta tag xml"><span class="punctuation definition tag xml"><span>&lt;</span></span><span class="entity name tag localname xml"><span>LinearLayout</span></span></span></span></div><div class="line"><span class="text xml"><span class="meta tag xml"><span>&nbsp;&nbsp;&nbsp;</span><span>&nbsp;</span><span class="entity other attribute-name namespace xml"><span>android</span></span><span class="entity other attribute-name xml"><span class="punctuation separator namespace xml"><span>:</span></span></span><span class="entity other attribute-name localname xml"><span>layout_width</span></span><span>=</span><span class="string quoted double xml"><span class="punctuation definition string begin xml"><span>&quot;</span></span><span>match_parent</span><span class="punctuation definition string end xml"><span>&quot;</span></span></span></span></span></div><div class="line"><span class="text xml"><span class="meta tag xml"><span>&nbsp;&nbsp;&nbsp;</span><span>&nbsp;</span><span class="entity other attribute-name namespace xml"><span>android</span></span><span class="entity other attribute-name xml"><span class="punctuation separator namespace xml"><span>:</span></span></span><span class="entity other attribute-name localname xml"><span>layout_height</span></span><span>=</span><span class="string quoted double xml"><span class="punctuation definition string begin xml"><span>&quot;</span></span><span>match_parent</span><span class="punctuation definition string end xml"><span>&quot;</span></span></span></span></span></div><div class="line"><span class="text xml"><span class="meta tag xml"><span>&nbsp;&nbsp;&nbsp;</span><span>&nbsp;</span><span class="entity other attribute-name namespace xml"><span>android</span></span><span class="entity other attribute-name xml"><span class="punctuation separator namespace xml"><span>:</span></span></span><span class="entity other attribute-name localname xml"><span>orientation</span></span><span>=</span><span class="string quoted double xml"><span class="punctuation definition string begin xml"><span>&quot;</span></span><span>vertical</span><span class="punctuation definition string end xml"><span>&quot;</span></span></span><span class="punctuation definition tag xml"><span>&gt;</span></span></span></span></div><div class="line"><span class="text xml"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag xml"><span class="punctuation definition tag xml"><span>&lt;</span></span><span class="entity name tag localname xml"><span>Button</span></span></span></span></div><div class="line"><span class="text xml"><span class="meta tag xml"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;</span><span class="entity other attribute-name namespace xml"><span>android</span></span><span class="entity other attribute-name xml"><span class="punctuation separator namespace xml"><span>:</span></span></span><span class="entity other attribute-name localname xml"><span>layout_width</span></span><span>=</span><span class="string quoted double xml"><span class="punctuation definition string begin xml"><span>&quot;</span></span><span>wrap_content</span><span class="punctuation definition string end xml"><span>&quot;</span></span></span></span></span></div><div class="line"><span class="text xml"><span class="meta tag xml"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;</span><span class="entity other attribute-name namespace xml"><span>android</span></span><span class="entity other attribute-name xml"><span class="punctuation separator namespace xml"><span>:</span></span></span><span class="entity other attribute-name localname xml"><span>layout_height</span></span><span>=</span><span class="string quoted double xml"><span class="punctuation definition string begin xml"><span>&quot;</span></span><span>wrap_content</span><span class="punctuation definition string end xml"><span>&quot;</span></span></span></span></span></div><div class="line"><span class="text xml"><span class="meta tag xml"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;</span><span class="entity other attribute-name namespace xml"><span>android</span></span><span class="entity other attribute-name xml"><span class="punctuation separator namespace xml"><span>:</span></span></span><span class="entity other attribute-name localname xml"><span>text</span></span><span>=</span><span class="string quoted double xml"><span class="punctuation definition string begin xml"><span>&quot;</span></span><span>ボタン</span><span class="punctuation definition string end xml"><span>&quot;</span></span></span><span>&nbsp;</span><span class="punctuation definition tag xml"><span>/&gt;</span></span></span></span></div><div class="line"><span class="text xml"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta tag xml"><span class="punctuation definition tag xml"><span>&lt;</span></span><span class="entity name tag localname xml"><span>TextView</span></span></span></span></div><div class="line"><span class="text xml"><span class="meta tag xml"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;</span><span class="entity other attribute-name namespace xml"><span>android</span></span><span class="entity other attribute-name xml"><span class="punctuation separator namespace xml"><span>:</span></span></span><span class="entity other attribute-name localname xml"><span>layout_width</span></span><span>=</span><span class="string quoted double xml"><span class="punctuation definition string begin xml"><span>&quot;</span></span><span>wrap_content</span><span class="punctuation definition string end xml"><span>&quot;</span></span></span></span></span></div><div class="line"><span class="text xml"><span class="meta tag xml"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;</span><span class="entity other attribute-name namespace xml"><span>android</span></span><span class="entity other attribute-name xml"><span class="punctuation separator namespace xml"><span>:</span></span></span><span class="entity other attribute-name localname xml"><span>layout_height</span></span><span>=</span><span class="string quoted double xml"><span class="punctuation definition string begin xml"><span>&quot;</span></span><span>wrap_content</span><span class="punctuation definition string end xml"><span>&quot;</span></span></span></span></span></div><div class="line"><span class="text xml"><span class="meta tag xml"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;</span><span class="entity other attribute-name namespace xml"><span>android</span></span><span class="entity other attribute-name xml"><span class="punctuation separator namespace xml"><span>:</span></span></span><span class="entity other attribute-name localname xml"><span>text</span></span><span>=</span><span class="string quoted double xml"><span class="punctuation definition string begin xml"><span>&quot;</span></span><span>Hello&nbsp;World!</span><span class="punctuation definition string end xml"><span>&quot;</span></span></span><span>&nbsp;</span><span class="punctuation definition tag xml"><span>/&gt;</span></span></span></span></div><div class="line"><span class="text xml"><span class="meta tag xml"><span class="punctuation definition tag xml"><span>&lt;/</span></span><span class="entity name tag localname xml"><span>LinearLayout</span></span><span class="punctuation definition tag xml"><span>&gt;</span></span></span></span></div></pre>
	<h2 id="actionbaractivity-">ActionBarActivity について</h2>
	<p>アクションバーは API Level 11 から導入され、それ以前で使いたければ「Android Support Library」を使う必要がある。 API Level 11 以降の Activty クラスにはアクションバーのコードが入っているが、10 未満では Activity クラスにアクションバーのコードが入ってないので、入っている ActionBarActivity (Support Library のクラス) を使う必要がある。 ※ Support Library 22 から ActionBarActivity
		は非推奨になり、AppCompatActivity を使うようにガイドされている。 ※ Support Library 22 からは専用のアクティビティを継承せず、AppCompatDelegate を使って移譲形式でアクションバーを使うことができる。AppCompatActivity は内部で AppCompatDelegate を使っているだけ。</p>

	<h1 id="-">ライフサイクル</h1>
	<h2 id="-">「ライフサイクル」とは？</h2>
	<ul>
		<li>アクティビティは「生成 → 表示 → 破棄」の過程で状態に応じてアクティビティ内のメソッドが呼ばれるようになっている。 この状態に応じて呼ばれるメソッドを『ライフサイクルメソッド』と言う。
		</li>
	</ul>
	<h2 id="-">ライフサイクル図</h2>
	<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>+---→&nbsp;実行中&nbsp;----+</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↓</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;onResume&nbsp;←--------&nbsp;onPause</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;</span><span class="meta paragraph text"><span>(触れる)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(触れなくなる)</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;↑&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↓</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;onStart&nbsp;←---&nbsp;onRestart&nbsp;----&nbsp;onStop</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>(見える)&nbsp;&nbsp;(見えないから見える)&nbsp;&nbsp;(見えなくなる)</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>↑&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↓</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>onCreate&nbsp;←-----------------------&nbsp;onDestroy</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>(生成される)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(破棄される)</span></span></span></div></pre>
	<h2 id="-">ライフサイクルの例</h2>
	<p>例1) A から B を起動</p>
	<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span>　[A]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　[B]</span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>実行中</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>onPause</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>onCreate</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onStart</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onResume</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;実行中</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>onStop</span></span></span></div></pre>
	<p>例2) バックキーで B から A に戻る</p>
	<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span>　&nbsp;A&nbsp;←--&nbsp;back&nbsp;---&nbsp;B</span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>実行中</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onPause</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>onRestart</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>onStart</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>onResume</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>実行中</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>onStop</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onDestroy</span></span></span></div></pre>
	<p>例3) A を表示している状態でホームボタン</p>
	<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>※&nbsp;A&nbsp;から&nbsp;B&nbsp;を起動パターンで&nbsp;B&nbsp;がホーム画面になっただけ。</span></span></span></div></pre>
	<p>例4) A を表示している状態で電源ボタン</p>
	<p>例5) A を表示している状態でアプリをバックグラウンドにして最近使ったアプリから削除</p>
	<p>例6) A を表示している状態でアプリをバックグラウンドにして Android システムによって終了</p>
	<h1 id="-">アクティビティの起動</h1>
	<h2 id="-">アクティビティの起動について</h2>
	<ul>
		<li>アクティビティの起動は Context クラスの「startActivity()」または「startActivityForResult()」で行う。両者の違いは下記の通り。
			<ul>
				<li>startActivity() アクティビティを起動する。
				</li>
				<li>startActivityForResult() アクティビティを起動し、起動先のアクティビティが閉じた際に起動元に結果を返す。
				</li>
			</ul>
		</li>
	</ul>
	<h2 id="startactivity-">startActivity() の例</h2>
	<ul>
		<li>AアクティビティからBアクティビティを起動する。</li>
	</ul>
	<p>[AActivity.java]</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;B&nbsp;アクティビティの起動</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source java"><span class="storage type java"><span>Intent</span></span><span>&nbsp;intent&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;</span><span class="storage type java"><span>Intent</span></span><span class="punctuation bracket round java"><span>(</span></span><span class="variable language this java"><span>this</span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="variable other object java"><span>BActivity</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>class</span></span><span class="punctuation bracket round java"><span>)</span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="meta function-call java"><span class="entity name function java"><span>startActivity</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>intent</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div></pre>
	<h2 id="startactivityforresult-">startActivityForResult() の例</h2>
	<ul>
		<li>
			<p>AアクティビティからBアクティビティを起動し、BアクティビティからAに結果を返す。</p>
		</li>
		<li>
			<p>手順</p>
			<ol>
				<li>B の起動に startActivityForResult() を使う</li>
				<li>B から A に戻る(Bを終了する)際に B 側で setResult() し結果をセットする。</li>
				<li>A に戻った際に onActivityResult() メソッドが呼ばれるのでそこで結果を取り出す。</li>
			</ol>
		</li>
		<li>
			<p>補足</p>
			<ul>
				<li>setResult()を設定せずに終了したり backキー押した場合も onActivityResult() が呼ばれ、結果コードに「RESULT_CANCELED(0)」が渡される。</li>
			</ul>
		</li>
	</ul>
	<p>[AActivity.java]</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="storage type annotation java"><span>@Override</span></span></span></div><div class="line"><span class="source java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>void</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>onClick</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>View</span></span><span>&nbsp;v</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>if</span></span><span>&nbsp;</span><span class="punctuation bracket round java"><span>(</span></span><span class="variable other object java"><span>v</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getId</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="keyword operator comparison java"><span>==</span></span><span>&nbsp;</span><span class="variable other object java"><span>R</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>id</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>b_button</span></span><span class="punctuation bracket round java"><span>)</span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span class="punctuation whitespace comment leading java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;B&nbsp;アクティビティの起動</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type java"><span>Intent</span></span><span>&nbsp;intent&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;</span><span class="storage type java"><span>Intent</span></span><span class="punctuation bracket round java"><span>(</span></span><span class="variable language this java"><span>this</span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="variable other object java"><span>BActivity</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>class</span></span><span class="punctuation bracket round java"><span>)</span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>startActivityForResult</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>intent</span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="constant numeric java"><span>10</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div></pre>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="storage type annotation java"><span>@Override</span></span></span></div><div class="line"><span class="source java"><span class="storage modifier java"><span>protected</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>void</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>onActivityResult</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type primitive java"><span>int</span></span><span>&nbsp;requestCode</span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>int</span></span><span>&nbsp;resultCode</span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="storage type java"><span>Intent</span></span><span>&nbsp;data</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span class="punctuation whitespace comment leading java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;結果コードのチェック</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>if</span></span><span>&nbsp;</span><span class="punctuation bracket round java"><span>(</span></span><span>resultCode&nbsp;</span><span class="keyword operator comparison java"><span>!=</span></span><span>&nbsp;</span><span class="storage type java"><span>RESULT_OK</span></span><span class="punctuation bracket round java"><span>)</span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>return</span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;</span></span></div><div class="line"><span class="source java"><span class="punctuation whitespace comment leading java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;リクエストコードごとに分岐</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>if</span></span><span>&nbsp;</span><span class="punctuation bracket round java"><span>(</span></span><span>requestCode&nbsp;</span><span class="keyword operator comparison java"><span>==</span></span><span>&nbsp;</span><span class="constant numeric java"><span>10</span></span><span class="punctuation bracket round java"><span>)</span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;Bからの戻りの場合</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source java"><span class="punctuation whitespace comment leading java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;結果データの取り出し</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type java"><span>String</span></span><span>&nbsp;value&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="variable other object java"><span>data</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getStringExtra</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>value</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;…&nbsp;結果を使った処理&nbsp;…</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div></pre>
	<p>[BActivity.java]</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;結果データを渡すインテントを作成</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source java"><span class="storage type java"><span>Intent</span></span><span>&nbsp;result&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;</span><span class="storage type java"><span>Intent</span></span><span class="punctuation bracket round java"><span>(</span><span>)</span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="variable other object java"><span>result</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>putExtra</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>value</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>xxxxxx</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;</span></span></div><div class="line"><span class="source java"><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;結果のセット</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source java"><span class="meta function-call java"><span class="entity name function java"><span>setResult</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>RESULT_OK</span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;result</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;</span></span></div><div class="line"><span class="source java"><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;アクティビティ終了</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source java"><span class="meta function-call java"><span class="entity name function java"><span>finish</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div></pre>
	<h2 id="-">アクティビティの起動/終了に関するメソッド</h2>
	<ul>
		<li>
			<p>Activity クラス</p>
		</li>
		<li>
			<p>public void startActivity(Intent intent)</p>
			<p> インテントを発行しアクティビティを起動する。</p>
			<p> intent: 発行するインテント</p>
		</li>
		<li>
			<p>public void startActivityForResult(Intent intent, int requestCode)</p>
			<p> インテントを発行しアクティビティを起動する。起動したアクティビティが終了されると呼び出し元アクティビティの onActivityResult() メソッドが呼ばれる。</p>
			<p> intent: 発行するインテント requestCode: 呼び出し元を区別するためのコード。onActivityResult() が呼ばれる際に引数の requestCode に渡ってくる。</p>
		</li>
		<li>
			<p>public void finish()</p>
			<p> アクティビティを終了する。</p>
			<p> &lt;!&gt; finish() でアクティビティは閉じられるがそのアクティビティが直ぐに破棄される(onDestroy()が呼ばれる)訳ではない。 アクティビティ破棄がスケジュールされてそれが処理されて onDestory() となる。</p>
		</li>
		<li>
			<p>public final void setResult(int resultCode)</p>
			<p> 呼び出し元アクティビティの onActivityResult() に渡す結果コードを設定する。</p>
			<p> resultCode: 結果コード。任意の値を設定可能だが、Activity.RESULT_CANCELED(0)、Activity.RESULT_OK(-1)が用意されていてこれをよく使う。</p>
		</li>
		<li>
			<p>public final void setResult(int resultCode, Intent data)</p>
			<p> 呼び出し元アクティビティの onActivityResult() に渡す結果コード、結果データを設定する。</p>
			<p> resultCode: 結果コード。任意の値を設定可能だが、Activity.RESULT_CANCELED(0)、Activity.RESULT_OK(-1)が用意されていてこれをよく使う。 data: 結果データ</p>
		</li>
		<li>
			<p>protected void onActivityResult(int requestCode, int resultCode, Intent data)</p>
			<p> startActivityForResult() で起動したアクティビティが終了する際に呼ばれるメソッド。</p>
			<p> requestCode: 呼び出し元を区別するためのコード resultCode: 結果コード。バックキーで戻った場合は Activity.RESULT_CANCELED(0) が渡される。 data: 結果データ。</p>
		</li>
	</ul>
	<h2 id="onactivityresult-">onActivityResult が呼ばれるかと渡されるパラメータの調査</h2>
	<p>※startActivityForResult(999, null) を実行する</p>
	<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>finish&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setResult(RESULT_OK)→finish</span></span></span></div></pre>
	<p>startActivity × × startActivityForResult ○(999, 0) ○(999, -1)</p>
	<p>A→BをstartActivityForResult()でBを起動して、Aが破棄されてるとBから戻った際に onCreate()→onActivityResult() の順で呼ばれてしまい、onCreate()で通信処理などを書いてるとonActivityResult()での通信と合わせて2回実行になってしまう。
	</p>
	<p>[対応] startActivityForResult()呼ぶ際にActivityのフィールドにonCreate()での通信をスキップするフラグをもたせる。 で、それを onSaveInstanceState() で退避させて、さらにそのフラグを onResume() でクリアするようにしておけばいい。</p>
	<p>※4.0.1では次の順番で呼ばれた。バージョンによって違ったりする？ onCreate → onActivityResult → onResume</p>
	<p>例) --</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span>&nbsp;</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>private</span></span><span>&nbsp;</span><span class="storage modifier java"><span>static</span></span><span>&nbsp;</span><span class="storage modifier java"><span>final</span></span><span>&nbsp;</span><span class="storage type java"><span>String</span></span><span>&nbsp;</span><span class="storage type java"><span>SKIP_LOAD_ON_CREATE</span></span><span>&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>skipLoadOnCreate</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block java"><span class="punctuation definition comment java"><span>/*</span></span><span>*&nbsp;onCreate()&nbsp;でロード処理をスキップするかどうかのフラグ&nbsp;</span><span class="punctuation definition comment java"><span>*/</span></span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>private</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>boolean</span></span><span>&nbsp;skipLoadOnCreate</span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>protected</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>void</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>onCreate</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>Bundle</span></span><span>&nbsp;savedInstanceState</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation separator period java"><span>.</span><span>.</span><span>.</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>if</span></span><span>&nbsp;</span><span class="punctuation bracket round java"><span>(</span></span><span>savedInstanceState&nbsp;</span><span class="keyword operator comparison java"><span>==</span></span><span>&nbsp;</span><span class="constant language java"><span>null</span></span><span>&nbsp;</span><span class="keyword operator logical java"><span>||</span></span><span>&nbsp;</span><span class="keyword operator logical java"><span>!</span></span><span class="variable other object java"><span>savedInstanceState</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getBoolean</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>SKIP_LOAD_ON_CREATE</span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="constant language java"><span>false</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation bracket round java"><span>)</span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>doLoad</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="constant numeric java"><span>1</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>protected</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>void</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>onResume</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language java"><span>super</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>onResume</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skipLoadOnCreate&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="constant language java"><span>false</span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>protected</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>void</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>onSaveInstanceState</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>Bundle</span></span><span>&nbsp;outState</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object java"><span>outState</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>putBoolean</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>SKIP_LOAD_ON_CREATE</span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;skipLoadOnCreate</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language java"><span>super</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>onSaveInstanceState</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>outState</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>protected</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>void</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>onActivityResult</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type primitive java"><span>int</span></span><span>&nbsp;requestCode</span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>int</span></span><span>&nbsp;resultCode</span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="storage type java"><span>Intent</span></span><span>&nbsp;data</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language java"><span>super</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>onActivityResult</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>requestCode</span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;resultCode</span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;data</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>if</span></span><span>&nbsp;</span><span class="punctuation bracket round java"><span>(</span></span><span>requestCode&nbsp;</span><span class="keyword operator comparison java"><span>==</span></span><span>&nbsp;</span><span class="constant numeric java"><span>10</span></span><span>&nbsp;</span><span class="keyword operator logical java"><span>&amp;&amp;</span></span><span>&nbsp;resultCode&nbsp;</span><span class="keyword operator comparison java"><span>==</span></span><span>&nbsp;</span><span class="storage type java"><span>RESULT_OK</span></span><span class="punctuation bracket round java"><span>)</span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>doLoad</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="constant numeric java"><span>2</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier java"><span>private</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>void</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>doLoad</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type primitive java"><span>int</span></span><span>&nbsp;i</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object java"><span>Log</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>d</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>■</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>call&nbsp;foo:&nbsp;</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator arithmetic java"><span>+</span></span><span>&nbsp;i</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div></pre>
	<p>~~</p>
	<p>※注意点 ・onActivityResult()は ・これだと飛び先画面で例外発生し、このアクティビティに戻ってきた際はロードが行われないが、そもそも落ちる状況がおかしいのでそれを考慮しなくていいと思う。 ・これだとbackキーで戻ってきた際にロードできない
	</p>
	<h1 id="-">アクティビティ間のデータ受け渡し</h1>
	<h2 id="-">ポイント</h2>
	<ul>
		<li>
			<p>アクティビティ A → B の起動でデータを渡したい場合は B を起動する際のインテントの「エクストラ」を使ってデータを渡す。</p>
		</li>
		<li>
			<p>DB やプリファレンスは永続化データなので画面間の受け渡しには適していない。 static なデータで渡すのは絶対にやってはいけない！ 理由はアプリがクラッシュした時、やバックグラウンドにいて Android システムがメモリ不足の際に行うバックグラウンドプロセスの破棄で プロセスは破棄されてしまう。プロセスが破棄されると JVM も再起動となり static 領域はクリアされるため。 システムによるプロセス kill はアクティビティがどこかのスタック上に残っている場合、再度ユーザーがタスク履歴からなどから選択するとプロセスを再起動しその途中のアクティビティを起動する。</p>
		</li>
		<li>
			<p>A から起動された B から A に戻る際(バックキーや finish())で、呼び出し元の A にデータを返したい場合、 B のアクティビティの起動に startActivityForResult() を用いて、A 側の onActivityResult() でデータを受け取る。 B から A を起動してインテントのエクストラで渡す形は好ましくない。 理由はアクティビティスタックに無駄に積まれたり、A 自体も他の画面から起動する際のエクストラを受け取っているわけで、それと B からの戻りのエクストラと混ざってコードが複雑になる。</p>
		</li>
	</ul>
	<ul>
		<li>A → B でデータを渡す例 ~~~
		</li>
	</ul>
	<p>[AActivity.java]</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="storage type java"><span>Intent</span></span><span>&nbsp;intent&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;</span><span class="storage type java"><span>Intent</span></span><span class="punctuation bracket round java"><span>(</span></span><span class="variable language this java"><span>this</span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="variable other object java"><span>BAcivity</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>class</span></span><span class="punctuation bracket round java"><span>)</span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="variable other object java"><span>intent</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>putExtra</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>no</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="constant numeric java"><span>1234</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="variable other object java"><span>intent</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>putExtra</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>name</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>xxxx</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="meta function-call java"><span class="entity name function java"><span>startActivity</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>intent</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div></pre>
	<p>[BActivity.java]</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="storage type java"><span>Intente</span></span><span>&nbsp;intent&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>getIntent</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="storage type primitive java"><span>int</span></span><span>&nbsp;no&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="variable other object java"><span>intent</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getIntExtra</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>no</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="constant numeric java"><span>0</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="storage type java"><span>String</span></span><span>&nbsp;name&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="variable other object java"><span>intent</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getStringExtra</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>name</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div></pre>
	<h2 id="a-b-">A → B でデータを渡す実践例</h2>
	<ul>
		<li>アクティビティ間でデータを受け渡す際は1つのクラスにまとめて渡すようにした方がよい。理由としては次のようなことがある。
			<ul>
				<li>String とか int などバラバラ渡す形だとその画面を呼ぶための必要なパラメーターの仕様が分からなくなってしまう。</li>
				<li>エクストラのキーの管理が面倒。 ※クラスで渡す場合はクラスの完全クラス名にすれば悩まなくて済む。
				</li>
				<li>必要なたびに Intent#getExtra() もしくはフィールドに全て保持しておくなど可読性が悪い。</li>
			</ul>
		</li>
	</ul>
	<p>[AActivity.java]</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="storage type java"><span>BParamDto</span></span><span>&nbsp;bParamDto&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;</span><span class="storage type java"><span>BParamDto</span></span><span class="punctuation bracket round java"><span>(</span><span>)</span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="variable other object java"><span>bParamDto</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>no</span></span><span>&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="constant numeric java"><span>1234</span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="variable other object java"><span>bParamDto</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>name</span></span><span>&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>xxxx</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;</span></span></div><div class="line"><span class="source java"><span class="storage type java"><span>Intent</span></span><span>&nbsp;intent&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;</span><span class="storage type java"><span>Intent</span></span><span class="punctuation bracket round java"><span>(</span></span><span class="variable language this java"><span>this</span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="variable other object java"><span>BAcivity</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>class</span></span><span class="punctuation bracket round java"><span>)</span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="variable other object java"><span>intent</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>putExtra</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="variable other object java"><span>BParamDto</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>class</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getCanonicalName</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;bParamDto</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="meta function-call java"><span class="entity name function java"><span>startActivity</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>intent</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div></pre>
	<p>[BActivity.java]</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="storage type java"><span>Intente</span></span><span>&nbsp;intent&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>getIntent</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="storage type java"><span>BParamDto</span></span><span>&nbsp;bParamDto&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="variable other object java"><span>intent</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getParcelableExtra</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="variable other object java"><span>BParamDto</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>class</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getCanonicalName</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div></pre>
	<h2 id="b-a-">B(終了) → A でデータを渡す例</h2>
	<p>[AActivity.java]</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="storage type java"><span>Intent</span></span><span>&nbsp;intent&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;(this,&nbsp;BActivity.class)</span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="meta function-call java"><span class="entity name function java"><span>startActivityForResult</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>intent</span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="constant numeric java"><span>10</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;</span></span></div><div class="line"><span class="source java"><span>&nbsp;</span></span></div><div class="line"><span class="source java"><span class="storage type annotation java"><span>@Override</span></span></span></div><div class="line"><span class="source java"><span class="storage modifier java"><span>protected</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>void</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>onActivityResult</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type primitive java"><span>int</span></span><span>&nbsp;requestCode</span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>int</span></span><span>&nbsp;resultCode</span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="storage type java"><span>Intent</span></span><span>&nbsp;data</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>if</span></span><span>&nbsp;</span><span class="punctuation bracket round java"><span>(</span></span><span>resultCode&nbsp;</span><span class="keyword operator comparison java"><span>!=</span></span><span>&nbsp;</span><span class="storage type java"><span>RESULT_OK</span></span><span class="punctuation bracket round java"><span>)</span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>return</span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>if</span></span><span>&nbsp;</span><span class="punctuation bracket round java"><span>(</span></span><span>requestCode&nbsp;</span><span class="keyword operator comparison java"><span>==</span></span><span>&nbsp;</span><span class="constant numeric java"><span>10</span></span><span class="punctuation bracket round java"><span>)</span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></div><div class="line"><span class="source java"><span class="punctuation whitespace comment leading java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;結果の受け取り</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type java"><span>ResultData</span></span><span>&nbsp;resultData&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="variable other object java"><span>data</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getParcelableExtra</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="variable other object java"><span>ResultData</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>class</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getCanonicalName</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div></pre>
	<p>[BActivity.java]</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="storage type java"><span>Intent</span></span><span>&nbsp;intent&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="keyword control new java"><span>new</span></span><span>&nbsp;</span><span class="storage type java"><span>Intent</span></span><span class="punctuation bracket round java"><span>(</span><span>)</span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="variable other object java"><span>intent</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>putExtra</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="variable other object java"><span>ResultData</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>class</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getCanonicalName</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;resultData</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="meta function-call java"><span class="entity name function java"><span>setResult</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>RESULT_OK</span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;intent</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div><div class="line"><span class="source java"><span class="meta function-call java"><span class="entity name function java"><span>finish</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></div></pre>
	<h1 id="-">アクティビティ状態の保存と復元</h1>
	<h2 id="-">ポイント</h2>
	<ul>
		<li>アクティビティは作り直される状況がある。作り直しとはインスタンスが別でそれまでに保持した状態が失われる。
			<ul>
				<li>端末の回転などのコンフィグレーションの変更による再起動</li>
				<li>バックグラウンドで破棄された後にフォアグラウンドに戻ってきた時の再起動</li>
			</ul>
		</li>
		<li>アクティビティが見なくなるタイミングで状態を退避し、再起動の場合にその退避した情報を受け取って状態を復元する機能がある。</li>
		<li>onSaveInstanceState は onStop の前に必ず呼ばれる。</li>
		<li>onRestoreInstanceState はアクティビティが再生成される場合でしか呼ばれない。</li>
		<li>再生成される場合は onRestoreInstanceState だけでなく onCreate でも状態がわたってくるのでこっち使った方がいい。</li>
	</ul>
	<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>+---→&nbsp;実行中&nbsp;----+</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↓</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>onResume&nbsp;←--------&nbsp;onPause</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>↑&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↓</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>(onRestoreInstanceState)&nbsp;&nbsp;onSaveInstanceState</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>↑&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↓</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>onStart&nbsp;←-------&nbsp;onRestart&nbsp;------&nbsp;onStop</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>↑&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↓</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>onCreate&nbsp;←-------------------------------&nbsp;onDestroy</span></span></span></div></pre>
	<h2 id="-">状態を保存/復元する例</h2>
	<ul>
		<li>ポイント
			<ol>
				<li>保存は onRestoreInstanceState() の引数に渡される Bundle (outState) にセットすることで行う。</li>
				<li>復元は onRestoreInstanceState() または onCreate() の引数の Bundle (savedInstanceState) から取り出して行う。</li>
				<li>再生成ではない場合、onCreate() の savedInstanceState は null が渡される。</li>
			</ol>
		</li>
	</ul>
	<h2 id="-">サンプル</h2>
	<p>[AActivity.java]</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="meta class java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta class identifier java"><span class="storage modifier java"><span>class</span></span><span>&nbsp;</span><span class="entity name type class java"><span>CountActivity</span></span></span><span>&nbsp;</span><span class="meta definition class inherited classes java"><span class="storage modifier extends java"><span>extends</span></span><span>&nbsp;</span><span class="entity other inherited-class java"><span>ActionBarActivity</span></span><span>&nbsp;</span></span><span class="meta definition class implemented interfaces java"><span class="storage modifier implements java"><span>implements</span></span><span>&nbsp;</span><span class="entity other inherited-class java"><span>View</span></span><span>.</span><span class="entity other inherited-class java"><span>OnClickListener</span></span><span>&nbsp;</span></span><span class="punctuation section class begin bracket curly java"><span>{</span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment block java"><span class="punctuation definition comment java"><span>/*</span></span><span>*&nbsp;カウント数&nbsp;</span><span class="punctuation definition comment java"><span>*/</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta definition variable java"><span class="storage modifier java"><span>private</span></span><span>&nbsp;</span><span class="storage type primitive java"><span>int</span></span><span>&nbsp;</span><span class="variable definition java"><span>mCount</span></span><span>&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="constant numeric java"><span>0</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>protected</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive java"><span>void</span></span></span><span>&nbsp;</span><span class="meta method identifier java"><span class="entity name function java"><span>onCreate</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>Bundle</span></span><span>&nbsp;</span><span class="variable parameter java"><span>savedInstanceState</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section method begin bracket curly java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language java"><span>super</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>onCreate</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>savedInstanceState</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>setContentView</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="variable other object java"><span>R</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>layout</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>count</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="punctuation whitespace comment leading java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;カウントアップボタン</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>findViewById</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="variable other object java"><span>R</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>id</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>count_plus_button</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>setOnClickListener</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="variable language this java"><span>this</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end bracket curly java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive java"><span>void</span></span></span><span>&nbsp;</span><span class="meta method identifier java"><span class="entity name function java"><span>onClick</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>View</span></span><span>&nbsp;</span><span class="variable parameter java"><span>v</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section method begin bracket curly java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta definition variable java"><span class="storage type primitive java"><span>int</span></span><span>&nbsp;</span><span class="variable definition java"><span>id</span></span><span>&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="variable other object java"><span>v</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getId</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control java"><span>if</span></span><span>&nbsp;</span><span class="punctuation bracket round java"><span>(</span></span><span>id&nbsp;</span><span class="keyword operator comparison java"><span>==</span></span><span>&nbsp;</span><span class="variable other object java"><span>R</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>id</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>count_plus_button</span></span><span class="punctuation bracket round java"><span>)</span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mCount</span><span class="keyword operator increment-decrement java"><span>++</span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object java"><span>Log</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>d</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>###</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>count=</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator arithmetic java"><span>+</span></span><span>&nbsp;mCount</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end bracket curly java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive java"><span>void</span></span></span><span>&nbsp;</span><span class="meta method identifier java"><span class="entity name function java"><span>onSaveInstanceState</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>Bundle</span></span><span>&nbsp;</span><span class="variable parameter java"><span>outState</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section method begin bracket curly java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language java"><span>super</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>onSaveInstanceState</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>outState</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="punctuation whitespace comment leading java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;カウント数の保存</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object java"><span>outState</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>putInt</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>count</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;mCount</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end bracket curly java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type annotation java"><span>@Override</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method java"><span class="storage modifier java"><span>public</span></span><span>&nbsp;</span><span class="meta method return-type java"><span class="storage type primitive java"><span>void</span></span></span><span>&nbsp;</span><span class="meta method identifier java"><span class="entity name function java"><span>onRestoreInstanceState</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>Bundle</span></span><span>&nbsp;</span><span class="variable parameter java"><span>savedInstanceState</span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section method begin bracket curly java"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object java"><span>Log</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>d</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="storage type java"><span>TAG</span></span><span class="punctuation separator delimiter java"><span>,</span></span><span>&nbsp;</span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>onRestoreInstanceState</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language java"><span>super</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>onRestoreInstanceState</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>savedInstanceState</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span class="punctuation whitespace comment leading java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash java"><span class="punctuation definition comment java"><span>//</span></span><span>&nbsp;カウント数の復元</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mCount&nbsp;</span><span class="keyword operator assignment java"><span>=</span></span><span>&nbsp;</span><span class="variable other object java"><span>savedInstanceState</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>getInt</span></span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span class="string quoted double java"><span class="punctuation definition string begin java"><span>&quot;</span></span><span>count</span><span class="punctuation definition string end java"><span>&quot;</span></span></span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span class="meta method java"><span class="meta method body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation section method end bracket curly java"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="punctuation section class end bracket curly java"><span>}</span></span></span></span></div></pre>
	<h2 id="-">ビューの状態の復元について</h2>
	<p>・端末を回転してアクティビティが再生するとアクティビティが作り直されるので EditText や ListView などのビューの状態もクリアされると思うかもしれないがそうではなく、状態は残ったままになっているはず。 ・実は View クラスにも「onSaveInstanceState()」「onRestoreInstanceState()」のメソッドがあり、標準のビューは再生成で状態を復元するようにこの中身が書かれている。 ・カスタムビューとかを作る場合で状態を保持したければ、カスタムビューで上記メソッドの中身を書く必要がある。
	</p>
	<h1 id="-">タスクダンプ</h1>
	<h2 id="-">コマンド</h2>
	<ul>
		<li>現在動作しているActivityやActivityスタックの状態をダンプ adb shell dumpsys activity activities</li>
	</ul>
	<h2 id="-">ダンプの見方</h2>
	<p>D:\android-sdk\platform-tools&gt;adb shell dumpsys activity activities</p>
	<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="storage type java"><span>ACTIVITY</span></span><span>&nbsp;</span><span class="storage type java"><span>MANAGER</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>ACTIVITIES</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>dumpsys&nbsp;activity&nbsp;activities</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;</span><span class="storage type java"><span>Main</span></span><span>&nbsp;stack</span><span class="keyword control ternary java"><span>:</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;</span><span class="keyword operator arithmetic java"><span>*</span></span><span>&nbsp;</span><span class="storage type java"><span>TaskRecord</span></span><span class="punctuation section block begin bracket curly java"><span>{</span></span><span>41b930f8&nbsp;#</span><span class="constant numeric java"><span>25</span></span><span>&nbsp;</span><span class="storage type java"><span>A</span></span><span>&nbsp;</span><span class="variable other object java"><span>s2</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>sample</span></span><span>&nbsp;</span><span class="storage type java"><span>U</span></span><span>&nbsp;</span><span class="constant numeric java"><span>0</span></span><span class="punctuation section block end bracket curly java"><span>}</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;←【1番前のタスク】</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;numActivities</span><span class="keyword operator assignment java"><span>=</span></span><span class="constant numeric java"><span>3</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;←【タスク内のアクティビティ数】</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;affinity</span><span class="keyword operator assignment java"><span>=</span></span><span class="variable other object java"><span>s2</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>sample</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;←【タスクアフィニティ】</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation separator period java"><span>.</span><span>.</span><span>.</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator arithmetic java"><span>*</span></span><span>&nbsp;</span><span class="storage type java"><span>Hist</span></span><span>&nbsp;#</span><span class="constant numeric java"><span>7</span></span><span class="keyword control ternary java"><span>:</span></span><span>&nbsp;</span><span class="storage type java"><span>ActivityRecord</span></span><span class="punctuation section block begin bracket curly java"><span>{</span></span><span>41b39e40&nbsp;</span><span class="variable other object java"><span>s2</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>sample</span></span><span class="keyword operator arithmetic java"><span>/</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>activity</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>FooActivity</span></span><span class="punctuation section block end bracket curly java"><span>}</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;←【タスク内のアクティビティ】</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation separator period java"><span>.</span><span>.</span><span>.</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type java"><span>Intent</span></span><span>&nbsp;</span><span class="punctuation section block begin bracket curly java"><span>{</span></span><span>&nbsp;flg</span><span class="keyword operator assignment java"><span>=</span></span><span class="constant numeric java"><span>0x400000</span></span><span>&nbsp;cmp</span><span class="keyword operator assignment java"><span>=</span></span><span class="variable other object java"><span>s2</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>sample</span></span><span class="keyword operator arithmetic java"><span>/</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>activity</span></span><span class="meta method-call java"><span class="punctuation separator period java"><span>.</span></span><span class="entity name function java"><span>BarActivity</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>has&nbsp;extras</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span>&nbsp;</span><span class="punctuation section block end bracket curly java"><span>}</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;←【こいつの起動につかったIntent？】</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation separator period java"><span>.</span><span>.</span><span>.</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;taskAffinity</span><span class="keyword operator assignment java"><span>=</span></span><span class="variable other object java"><span>s2</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>sample</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;←【アクティビティのタスクアフィニティ】</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation separator period java"><span>.</span><span>.</span><span>.</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator arithmetic java"><span>*</span></span><span>&nbsp;</span><span class="storage type java"><span>Hist</span></span><span>&nbsp;#</span><span class="constant numeric java"><span>6</span></span><span class="keyword control ternary java"><span>:</span></span><span>&nbsp;</span><span class="storage type java"><span>ActivityRecord</span></span><span class="punctuation section block begin bracket curly java"><span>{</span></span><span>41be5cd0&nbsp;</span><span class="variable other object java"><span>s2</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>sample</span></span><span class="keyword operator arithmetic java"><span>/</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other object property java"><span>activity</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>BuzActivity</span></span><span class="punctuation section block end bracket curly java"><span>}</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation separator period java"><span>.</span><span>.</span><span>.</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;</span><span class="keyword operator arithmetic java"><span>*</span></span><span>&nbsp;</span><span class="storage type java"><span>TaskRecord</span></span><span class="punctuation section block begin bracket curly java"><span>{</span></span><span>41b930f8&nbsp;#</span><span class="constant numeric java"><span>25</span></span><span>&nbsp;</span><span class="storage type java"><span>A</span></span><span>&nbsp;</span><span class="variable other object java"><span>s2</span></span><span class="punctuation separator period java"><span>.</span></span><span class="variable other property java"><span>sample</span></span><span>&nbsp;</span><span class="storage type java"><span>U</span></span><span>&nbsp;</span><span class="constant numeric java"><span>0</span></span><span class="punctuation section block end bracket curly java"><span>}</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;←【2番目のタスク】</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation separator period java"><span>.</span><span>.</span><span>.</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;</span><span class="storage type java"><span>Running</span></span><span>&nbsp;</span><span class="meta function-call java"><span class="entity name function java"><span>activities</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin bracket round java"><span>(</span></span><span>most&nbsp;recent&nbsp;first</span><span class="punctuation definition parameters end bracket round java"><span>)</span></span></span><span class="keyword control ternary java"><span>:</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;←【なんだろう？】</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation separator period java"><span>.</span><span>.</span><span>.</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;</span><span class="storage type java"><span>Recent</span></span><span>&nbsp;tasks</span><span class="keyword control ternary java"><span>:</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;←【なんだろう？】</span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation separator period java"><span>.</span><span>.</span><span>.</span></span></span></div><div class="line"><span class="source java"><span>&nbsp;&nbsp;mCurTask</span><span class="keyword control ternary java"><span>:</span></span><span>&nbsp;</span><span class="constant numeric java"><span>28</span></span></span></div></pre>
	<ul>
		<li>「Hist #n」の「n」はタスク関係なく全アクティビティの通し番号っぽい</li>
	</ul>
	<h1 id="-">プロセス・タスク・スタック</h1>
	<h2 id="-">プロセスとは？</h2>
	<ul>
		<li>「プロセス」とはアプリを実行している Linux プロセスのこと。 Android は JVM 上で動くのでこのプロセスは要は Java プロセスということになる。</li>
		<li>特にアプリで設定しない限りアプリのプロセスは1つ。</li>
	</ul>
	<h2 id="-">タスクとは？</h2>
	<ul>
		<li>
			<p>複数のアクティビティをまとめるもので、タスクはスタックを1つもっていてそこにアクティビティを積んでまとめる。 ※イメージ的には次のようなものを想像すればなんとなく分かりやすいかも。
			</p>
			<pre class="editor-colors lang-java"><div class="line"><span class="source java"><span class="meta class java"><span>&nbsp;&nbsp;</span><span class="meta class identifier java"><span class="storage modifier java"><span>class</span></span><span>&nbsp;</span><span class="entity name type class java"><span>Task</span></span></span><span>&nbsp;</span><span class="punctuation section class begin bracket curly java"><span>{</span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta definition variable java"><span class="storage type java"><span>String</span></span><span>&nbsp;</span><span class="variable definition java"><span>taskName</span></span></span><span class="punctuation terminator java"><span>;</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type java"><span>List</span></span><span class="punctuation bracket angle java"><span>&lt;</span></span><span class="storage type generic java"><span>Activity</span></span><span class="punctuation bracket angle java"><span>&gt;</span></span><span>&nbsp;stack</span><span class="punctuation terminator java"><span>;</span></span></span></span></span></div><div class="line"><span class="source java"><span class="meta class java"><span class="meta class body java"><span>&nbsp;&nbsp;</span></span><span class="punctuation section class end bracket curly java"><span>}</span></span></span></span></div></pre>
		</li>
		<li>
			<p>タスクは Android システム内に複数個存在し、フォアグラウンド・バックグラウンドに移動します。ユーザーにはフォアグラウンドタスクが見える事になります。</p>
		</li>
	</ul>
	<p>例)<br> [タスク1] [タスク2] [タスク3] ｜ ｜タスク2のアプリがランチャーから選択 ↓ [タスク1] [タスク3] [タスク2]</p>
	<ul>
		<li>ユーザーが一定期間タスクから離れる(バックグラウンドにする)と Android システムはタスクをクリアします。 そのクリアされたタスクをユーザーがフォアグラウンドに戻そうとするとタスクのルートアクティビティが起動します。
		</li>
	</ul>
	<h2 id="-">スタックとは？</h2>
	<ul>
		<li>「スタック」「バックスタック」「アクティビティスタック)」などと言う。</li>
		<li>
			<p>Android ではアクティビティを起動するとアクティビティが切り替わるのではなくスタック状に積まれていき、ユーザーには一番上に積まれたアクティビティが見える仕組みになっている。このアクティビティを積むスタックのことを「バックスタック、アクティビティスタック」と呼ぶ。 例) A から B を起動した場合</p>
			<p> | | | | | | ---→ | B | | A | | A | +-------+ +-------+</p>
		</li>
		<li>
			<p>アクティビティを finish() したりバックキーで閉じるとそのアクティビティはスタックから削除される。</p>
		</li>
		<li>スタックの一番下にいるアクティビティを「ルートアクティビティ」と呼ぶ。</li>
		<li>ルートアクティビティがスタックから無くなるとスタック自体が無くなる。正確にはスタックを持っているタスクが消えます。</li>
		<li>スタックに積むアクティビティはプロセスが異なるアクティビティも積む事ができます。 例) アプリから外部ブラウザ(Chromeアプリ)を起動</li>
	</ul>
	<p>B (Chromeアプリプロセス) A (自身のアプリプロセス)</p>
</body>
</html>
